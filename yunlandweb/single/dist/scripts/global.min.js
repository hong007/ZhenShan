angular.module("xn.directive.common",["xn/template/common.html"]).provider("xnValidator",[function(){var e={required:"该选项不能为空",maxlength:"该选项输入值长度不能大于{maxlength}",minlength:"该选项输入值长度不能小于{minlength}",email:"输入邮件的格式不正确",repeat:"两次输入不一致",pattern:"该选项输入格式不正确",number:"必须输入数字",xnuniquecheck:"该输入值已经存在，请重新输入"},n=["text","password","email","number",["textarea"],["select"],["select-one"]],t=function(){this.elemTypes=n,this.rules=[],this.isEmpty=function(e){return void 0===e||null===e?!0:e instanceof Array&&0===e.length?!0:!1},this.defaultShowError=function(e,n){var t=angular.element(e),i=t.parent().parent();this.isEmpty(i)||i.hasClass("has-error")||(i.addClass("has-error"),t.after('<span class="xn-error">'+n[0]+"</span>"))},this.defaultRemoveError=function(e){var n=angular.element(e),t=n.parent().parent();!this.isEmpty(t)&&t.hasClass("has-error")&&(t.removeClass("has-error"),n.next(".xn-error").remove())},this.options={blurTrig:!1}};t.prototype={constructor:t,config:function(e){this.options=angular.extend(this.options,e)},setRules:function(e){this.rules=e},getErrorMessage:function(n,t){var i=null;switch(this.isEmpty(this.rules[t.name])||this.isEmpty(this.rules[t.name][n])||(i=this.rules[t.name][n]),n){case"maxlength":return null!==i?i.replace("{maxlength}",t.getAttribute("ng-maxlength")):e.maxlength.replace("{maxlength}",t.getAttribute("ng-maxlength"));case"minlength":return null!==i?i.replace("{minlength}",t.getAttribute("ng-minlength")):e.minlength.replace("{minlength}",t.getAttribute("ng-minlength"));default:if(null!==i)return i;if(null===e[n])throw new Error("该验证规则("+n+")默认错误信息没有设置！");return e[n]}},getErrorMessages:function(e,n){var t=[];for(var i in n)if(n[i]){var o=this.getErrorMessage(i,e);t.push(o)}return t},showError:function(e,n,t){var i=angular.extend({},this.options,t);if(i.showError!==!1)return angular.element(e).removeClass("valid").addClass("error"),angular.isFunction(i.showError)?i.showError(e,n):i.showError===!0?this.defaultShowError(e,n):void 0},removeError:function(e,n){var t=angular.extend({},this.options,n);if(t.removeError!==!1)return angular.element(e).removeClass("error").addClass("valid"),angular.isFunction(t.removeError)?t.removeError(e):t.removeError===!0?this.defaultRemoveError(e):void 0}};var i=new t;this.config=function(e){i.config(e)},this.setRules=function(e){i.setRules(e)},this.$get=function(){return i}}]).directive("xnCheckboxList",function(){"use strict";return{restrict:"AC",templateUrl:"xn/template/common/checkboxList.html",scope:{checkboxs:"=ngModel"},require:"?ngModel",link:function(e,n,t,i){if(i){{e.checkboxs={listKey:[],list:[]}}t.$observe("checkboxList",function(n){e.checkList=JSON.parse(n),angular.forEach(e.checkList,function(n){n.state&&(e.checkboxs.listKey.push(n.key),e.checkboxs.list.push(n))})}),e.change=function(n,t,i){if(n){var o=0;angular.forEach(e.checkboxs.listKey,function(n){return n==t?void e.checkboxs.listKey.splice(o,1):void o++});var r=0;angular.forEach(e.checkboxs.list,function(n){return n.key==t?void e.checkboxs.list.splice(r,1):void r++})}else e.checkboxs.listKey.push(t),e.checkboxs.list.push(i)}}}}}).directive("xnDisabled",["XN_BEGIN_REQUEST","XN_END_REQUEST",function(e,n){"use strict";return{restrict:"A",link:function(t,i){t.$on(e,function(){i.attr({disabled:"disabled"}),i.addClass("disabled")}),t.$on(n,function(){i.attr({disabled:"true"}),i.removeClass("disabled"),i.removeAttr("disabled")})}}}]).directive("xnRepeat",[function(){"use strict";return{restrict:"AE",require:"ngModel",link:function(e,n,t,i){var o=n.inheritedData("$formController")[t.xnRepeat];i.$parsers.push(function(e){return e===o.$viewValue?(i.$setValidity("repeat",!0),e):void i.$setValidity("repeat",!1)}),o.$parsers.push(function(e){return i.$setValidity("repeat",e===i.$viewValue),e})}}}]).directive("xnUniqueCheck",["$timeout","$http",function(e,n){return{require:"ngModel",link:function(t,i,o,r){var a=function(){var e=t.$eval(o.xnUniqueCheck),i=e.url,a=e.isExists;n.get(i).success(function(e){a===!1?r.$setValidity("xnuniquecheck",e.data):r.$setValidity("xnuniquecheck",!e.data)})};t.$watch(o.ngModel,function(e){_.isEmpty(e)||t[i[0].form.name][i[0].name].$dirty||a()}),i.bind("blur",function(){e(function(){t[i[0].form.name][i[0].name].$invalid||a()})}),i.bind("focus",function(){e(function(){r.$setValidity("xnuniquecheck",!0)})})}}}]).directive("xnHasPermission",["permissionService",function(e){return{link:function(n,t,i){function o(){var n=e.hasPermission(r);n&&!a||!n&&a?t.show():t.hide()}if(!_.isString(i.xnHasPermission))throw"hasPermission value must be a string";var r=i.xnHasPermission.trim(),a="!"===r[0];a&&(r=r.slice(1).trim()),o(),n.$on("permissionsChanged",o)}}}]).directive("xnLoading",["XN_BEGIN_REQUEST","XN_END_REQUEST",function(e,n){return{restrict:"A",link:function(t,i){i.hide(),t.$on(e,function(){i.show()}),t.$on(n,function(){i.hide()})}}}]).directive("xnImg",[function(){return{restrict:"AE",link:function(e,n){n.bind("error",function(){n.attr({src:"/home/images/logo.jpg"})})}}}]).directive("xnRequired",[function(){return{restrict:"AEC",link:function(e,n){void 0==n.attr("placeholder")?n.attr("placeholder","(必填)"):n.attr("placeholder",n.attr("placeholder")+"(必填)")}}}]).directive("xnHasFocus",function(){return{link:function(e,n,t){e.$watch(t.xnHasFocus,function(e,t){t&&n[0].focus()}),n.bind("blur",function(){e.$apply(t.xnHasFocus+" = false")}),n.bind("keydown",function(n){13==n.which&&e.$apply(t.xnHasFocus+" = false")})}}}).directive("xnClickEdit",function(){return{require:"?ngModel",restrict:"AE",link:function(e,n){n.bind("click",function(){n.addClass("xn-click-edit-hover"),n.find(".xn-click-input").show(),n.find(".xn-click-input").focus()}),n.find(".xn-click-input").bind("blur",function(){n.removeClass("xn-click-edit-hover"),n.find(".xn-click-input").hide()})}}}).directive("xnFixTop",[function(){return{restrict:"C",scope:{yOffset:"@",yShifting:"@"},link:function(e,n){e.yShifting||(e.yShifting=0),e.yOffset||(e.yOffset=0);var t=$(n).offset().top,i=$(n).css("width");$.event.add(window,"scroll",function(){var o=$(window).scrollTop();$(n).css("position",o+Number(e.yShifting)>t?"fixed":"relative"),$(n).css("top",o+Number(e.yShifting)>t?e.yOffset:""),$(n).css("width",i)})}}}]).directive("xnBackToTop",["$location","$anchorScroll",function(e,n){return{template:"<ul>\n<li class='backToTop'>\n<a  ng-click='backToTop(header,0)'>\n<span class='gotop-icon icon  icon-up-1'></span><span class='gotop-font'>返回<br>顶部</span></a>\n</li>\n<li>\n<a ng-href='{{url}}' target='_blank'>\n<span class='gotop-icon icon icon-idea'></span><span class='gotop-font'>反馈<br>建议</span></a>\n</li>\n</ul>",restrict:"C",link:function(t,i,o){o.$observe("feedbackUrl",function(e){e&&(t.url=e)}),t.backToTop=function(t){e.hash(t),n()}}}}]).directive("xnPositiveNumber",function(){return{restrict:"A",require:"^ngModel",scope:{data:"=ngModel"},link:function(e){e.data||(e.data=0),e.data<0&&(e.data=-e.data),e.$watch("data",function(){e.data<0&&(e.data=-e.data)})}}}).directive("xnTagInput",[function(){return{restrict:"AE",scope:{data:"=ngModel"},require:"ngModel",priority:1,link:function(e,n,t,i){if(i){var o=e.data;o||(o="");var r=[];o.length>0&&(r=JSON.parse(o));var a=0;e.bindDelete=function(n){$("#"+n).on("click",function(){$("#li"+$(this).attr("id")).remove(),r.splice(Number($(this).attr("id")),1),o=JSON.stringify(r),i.$setViewValue(o),a=0,$("#last_li").prevAll().remove();for(var n=0;n<r.length;n++)$("#last_li").before("<li id='li"+(a>=10?a:"0"+a)+"' class='con_li'><div>"+r[n]+"</div><a href='javascript:void(0);' class='li_a' id='"+(a>=10?a:"0"+a)+"'><i class='icon icon-delete'></i></a></li>"),e.bindDelete(a>=10?a:"0"+a),a++})},e.init=function(){var t="<div class='xnInput_out_div' id='xnInput_out_div01'><ul id='inner_ul' class='xnInput_ul'>";t+="<li id='last_li'><input type='text' id='xnInput_input01' class='xnInput_input'/></li></ul></div>",$(n).before(t);for(var i=0;i<r.length;i++)$("#last_li").before("<li id='li"+(a>=10?a:"0"+a)+"' class='con_li'><div>"+r[i]+"</div><a href='javascript:void(0);' class='li_a' id='"+(a>=10?a:"0"+a)+"'><i class='icon icon-delete'></i></a></li>"),e.bindDelete(a>=10?a:"0"+a),a++;$("#xnInput_input01").on("focus",function(){$("#xnInput_out_div01").addClass("input_outline")}),$("#xnInput_input01").on("blur",function(){$("#xnInput_out_div01").removeClass("input_outline")}),$("#xnInput_out_div01").on("click",function(){$("#xnInput_input01").focus()})},e.init(),$("#xnInput_input01").on("keydown",function(n){13==n.keyCode&&$(this).val()&&(r.push($(this).val()),o=JSON.stringify(r),i.$setViewValue(o),$("#last_li").before("<li id='li"+(a>=10?a:"0"+a)+"' class='con_li'><div>"+$(this).val()+"</div><a href='javascript:void(0);' class='li_a' id='"+(a>=10?a:"0"+a)+"'><i class='icon icon-delete'></i></a></li>"),$(this).val(""),e.bindDelete(a>=10?a:"0"+a),a++)}),i.$parsers.push(function(e){var t=$(n).prev();return $(t).toggleClass("ng-invalid",!i.$valid).toggleClass("ng-valid",i.$valid).toggleClass("ng-invalid-required",!i.$valid).toggleClass("ng-valid-required",i.$valid).toggleClass("ng-dirty",i.$dirty).toggleClass("ng-pristine",i.$pristine),e})}}}}]).value("markdownConfig",{}).directive("xnMarkdown",["markdownConfig",function(e){var n={language:"zh",fullscreen:{enable:!0},resize:"vertical",localStorage:"md",abledButtons:{groupUtil:"cmdPreview"}},n=angular.extend(n,e),t=0,i=function(e,i,o,r){if(r){var a="";o.id?a=o.id:(a="markdown"+(t++>=10?t++:"0"+t++),$(i).attr("id",a)),$("#"+a).markdown(n),$(i).attr("data-provide","markdown"),$(i).on("blur",function(){r.$setViewValue($(this).val())})}},o=function(){return i};return{restrict:"AE",priority:10,scope:{data:"=ngModel"},require:"ngModel",compile:o}}]),angular.module("xn/template/common.html",[]).run(["$templateCache",function(e){"use strict";e.put("xn/template/common/checkboxList.html",'<div class=\'checkboxList-outer\'>	<label class="mr_15 xn-label-checkbox" for="{{checkbox.key}}{{$index}}" ng-repeat="checkbox in checkList">  		<i class="xn-checkbox"></i>  		<i class="icon icon-right_3" ng-if="checkbox.state"></i>   	<input type="checkbox" class="xn-checkbox-input" id="{{checkbox.key}}{{$index}}" name="{{checkbox.key}}{{$index}}" ng-click="change(checkbox.state,checkbox.key,checkbox)"        ng-model="checkbox.state">{{checkbox.value}}	</label></div>')}]),angular.module("xn/template/dialog/confirm.html",[]).run(["$templateCache",function(e){"use strict";e.put("xn/template/dialog/confirm.html",'<div class="modal-header">\n    <h3>{{dialogOptions.headerText}}</h3>\n    <div class="xn-close xn-cursor" data-ng-click="dialogOptions.close()">\n        <i class="icon icon-delete"></i>\n    </div>\n </div>\n    <div class="modal-body" ng-if="dialogOptions.type!=\'delete\'">\n        <p>{{dialogOptions.bodyText}}</p>\n    </div>\n    <div class="modal-body" ng-if="dialogOptions.type==\'delete\'">\n        <div class="xn-exclamation"><span>!</span></div>\n        <div class="xn-body-text">\n            <h4>{{dialogOptions.bodyText}}</h4>\n            <p></p>\n        </div>\n    </div>\n<div class="modal-footer">\n   <button type="button"class="btn"\n   data-ng-click="dialogOptions.close()">{{dialogOptions.closeButtonText}}\n    </button>\n   <button class="btn btn-danger"\n   data-ng-click="dialogOptions.callback();">{{dialogOptions.actionButtonText}}\n     </button>\n </div>')}]),angular.module("xn/template/dialog/info.html",[]).run(["$templateCache",function(e){"use strict";e.put("xn/template/dialog/info.html",'<div class="modal-header">\n    <h3>{{dialogOptions.headerText}}</h3>\n </div>\n    <div class="modal-body">\n   <p>{{dialogOptions.bodyText}}</p>\n    </div>\n<div class="modal-footer">\n   <button type="button"class="btn"\n   data-ng-click="dialogOptions.close()">{{dialogOptions.closeButtonText}}\n    </button>\n </div>')}]),angular.module("xn/template/dialog/error.html",[]).run(["$templateCache",function(e){"use strict";e.put("xn/template/dialog/error.html",'<div class="modal-header">\n    <h3>{{dialogOptions.headerText}}</h3>\n </div>\n    <div class="modal-body">\n   <p>{{dialogOptions.bodyText}}</p>\n    </div>\n<div class="modal-footer">\n   <button type="button"class="btn"\n   data-ng-click="dialogOptions.close()">{{dialogOptions.closeButtonText}}\n    </button>\n </div>')}]),angular.module("xn/template/dialog/warn.html",[]).run(["$templateCache",function(e){"use strict";e.put("xn/template/dialog/warn.html",'<div class="modal-header">\n    <h3>{{dialogOptions.headerText}}</h3>\n </div>\n    <div class="modal-body">\n   <p>{{dialogOptions.bodyText}}</p>\n    </div>\n<div class="modal-footer">\n   <button type="button"class="btn"\n   data-ng-click="dialogOptions.close()">{{dialogOptions.closeButtonText}}\n    </button>\n </div>')}]),angular.module("xn/template/dialog/success.html",[]).run(["$templateCache",function(e){"use strict";e.put("xn/template/dialog/success.html",'<div class="modal-header">\n    <h3>{{dialogOptions.headerText}}</h3>\n </div>\n    <div class="modal-body">\n   <p>{{dialogOptions.bodyText}}</p>\n    </div>\n<div class="modal-footer">\n   <button type="button"class="btn"\n   data-ng-click="dialogOptions.close()">{{dialogOptions.closeButtonText}}\n    </button>\n </div>')}]),angular.module("xn.service.tpl",["xn/template/dialog/confirm.html","xn/template/dialog/info.html","xn/template/dialog/error.html","xn/template/dialog/warn.html","xn/template/dialog/success.html"]),angular.module("xn.service.common",["xn.service.tpl","ui.bootstrap"]).service("toolsService",[function(){"use strict";this.parameter=function(e,n){var t=null,i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)");t=n.substr(n.indexOf("?"),n.length);var o=t.substr(1).match(i);return null!=o?unescape(o[2]):null}}]).service("dialogService",["$modal","$timeout","$document","$http",function(e,n,t){"use strict";this.confirm=function(n,t){var i={backdrop:!0,keyboard:!0,backdropClick:!0,dialogFade:!0,templateUrl:"xn/template/dialog/confirm.html",size:"sm"},o={closeButtonText:"关闭",actionButtonText:"确定",headerText:"继续...?",bodyText:"执行这个操作?"},r={},a={};angular.extend(r,i,n),angular.extend(a,o,t),r.controller||(r.controller=["$scope","$modalInstance",function(e,n){e.dialogOptions=a,e.dialogOptions.close=function(e){n.close(e)},e.dialogOptions.callback=function(){n.close(),t.callback()}}]),e.open(r)},this.info=function(n){var t={closeButtonText:"关闭",headerText:"提示信息",bodyText:n};e.open({backdrop:!0,keyboard:!0,backdropClick:!0,dialogFade:!0,size:"sm",templateUrl:"xn/template/dialog/info.html",controller:["$scope","$modalInstance",function(e,n){e.dialogOptions=t,e.dialogOptions.close=function(){n.close()}}]})},this.success=function(n){var t={closeButtonText:"关闭",headerText:"成功信息",bodyText:n};e.open({backdrop:!0,keyboard:!0,backdropClick:!0,dialogFade:!0,size:"sm",templateUrl:"xn/template/dialog/success.html",controller:["$scope","$modalInstance",function(e,n){e.dialogOptions=t,e.dialogOptions.close=function(){n.close()}}]})},this.error=function(n){var t={closeButtonText:"关闭",headerText:"错误信息",bodyText:n};e.open({backdrop:!0,keyboard:!0,backdropClick:!0,dialogFade:!0,size:"sm",templateUrl:"xn/template/dialog/error.html",controller:["$scope","$modalInstance",function(e,n){e.dialogOptions=t,e.dialogOptions.close=function(){n.close()}}]})},this.warn=function(n){var t={closeButtonText:"关闭",headerText:"警告信息",bodyText:n};e.open({backdrop:!0,keyboard:!0,backdropClick:!0,dialogFade:!0,size:"sm",templateUrl:"xn/template/dialog/warn.html",controller:["$scope","$modalInstance",function(e,n){e.dialogOptions=t,e.dialogOptions.close=function(){n.close()}}]})},this.tip=function(e,i,o){var r={headerText:"信息提示",bodyText:e,show:"show",size:"sm",top:"30%",removeTime:1e3,stopTime:3e3},a="",s="";null!=o&&(r.stopTime=o);for(var l=0;l<r.bodyText.length;l++)"STACK_DUMP"!=r.bodyText[l].type?a+="<p><span>"+(l+1)+".</span>"+r.bodyText[l].message+"</p>\n":s+=r.bodyText[l].message;var c='<div class="modal ng-isolate-scope xn-modal xn-modal-sm" >\n<div class="modal-content ">\n<div class="modal-header">\n <h3>'+r.headerText+'</h3>\n </div>\n<div class="modal-body">\n'+a+"</div>";""!=s&&(s=escape(s),c+="<form action='/api/errorHandler.do' method='post' target='_blank'><div class=\"modal-foot xn-text-right xn-padding-bottom xn-padding-right\"><input type='submit' value='更多' class='btn btn-link' /><input type='hidden' name='error' value='"+s+"' /></div></form>");var d=t.find("body").eq(0);d.append(c),d.find(".xn-modal").css({top:r.top,opacity:r.show}),d.find(".xn-modal").fadeIn(r.show);var u=function(){d.find(".xn-modal").animate({top:"0",opacity:"hide"},r.removeTime);var e=function(){d.find(".xn-modal").remove(),void 0!=i&&null!=i&&(window.location=i)};n(e,r.removeTime)};n(u,r.stopTime)}}]).factory("permissionService",["$rootScope",function(e){var n;return{setPermissions:function(t){console.log("XN:permissionService ,设置权限列表集合"+t),n=t,e.$broadcast("permissionsChanged")},hasPermission:function(e){return console.log("XN:权限项判断， value＝"+e),console.log("XN:权限项判断， permissionList＝"+n),e=e.trim().toLowerCase(),_.some(n,function(n){return console.log("遍历项＝"+n),_.isString(n)?n.trim().toLowerCase()===e:void 0})}}}]);var httpInterceptor=function(e,n,t,i,o){"use strict";var r,a,s={request:function(e){return e.requestTimestamp=(new Date).getTime(),a=a||n.get("$rootScope"),a.$broadcast(i),e},response:function(e){e.config.responseTimestamp=(new Date).getTime();var t=e.config.responseTimestamp-e.config.requestTimestamp;return console.log("请求共花费了： "+t/1e3+"秒."),r=r||n.get("$http"),r.pendingRequests.length<1&&(a=a||n.get("$rootScope"),a.$broadcast(o)),e},requestError:function(n){return e.reject(n)},responseError:function(t){switch(r=r||n.get("$http"),r.pendingRequests.length<1&&(a=a||n.get("$rootScope"),a.$broadcast(o)),t.status){case 401:console.error("XN:服务器返回401错误");break;case 403:console.error("XN:服务器返回403错误");break;case 404:console.error("XN:服务器返回404错误");break;case 500:console.error("XN:服务器返回500错误");break;default:console.error("XN:服务器返回错误")}return e.reject(t)}};return s};angular.module("xn.service.interceptor",["xn.service.common"]).constant("XN_BEGIN_REQUEST","XN_BEGIN_REQUEST").constant("XN_END_REQUEST","XN_END_REQUEST").factory("httpInterceptor",["$q","$injector","$location","XN_BEGIN_REQUEST","XN_END_REQUEST",httpInterceptor]),angular.module("xn.directive.form",[]).directive("xnFormValidate",["$parse","xnValidator",function(e,n){return{link:function(t,i,o){var r=i[0],a=i.attr("name"),s=e(o.xnSubmit),l=t.$eval(o.xnFormValidate);o.xnFormValidate&&t.$watch(o.xnFormValidate,function(e){e&&(l=angular.extend({},n.options,e))},!0),l=angular.extend({},n.options,l);for(var c=0;c<r.length;c++){var d=r[c],u=angular.element(d);if(n.elemTypes.toString().indexOf(d.type)>-1&&!n.isEmpty(d.name)){var p=a+"."+d.name+".$viewValue";t.$watch("["+p+","+c+"]",function(e){var i=r[e[1]];t[a].$errors=[],n.removeError(i,l)},!0),l.blurTrig&&u.bind("blur",function(){if(l.blurTrig){var e=angular.element(this);if(t[a][this.name].$valid)n.removeError(e,l);else{var i=n.getErrorMessages(this,t[a][this.name].$error);n.showError(e,i,l)}}})}}var m=function(){for(var e=[],i=0;i<r.length;i++){var o=r[i];if(n.elemTypes.toString().indexOf(o.type)>-1&&!n.isEmpty(o.name)&&t[a][o.name]){if(t[a][o.name].$valid){angular.element(o).removeClass("error").addClass("valid");continue}var s=n.getErrorMessages(o,t[a][o.name].$error);e.push(s[0]),n.removeError(o,l),n.showError(o,s,l),angular.element(o).removeClass("valid").addClass("error")}}t[a].$errors=!n.isEmpty(e)&&e.length>0?e:[],t.$$phase||t.$apply(t[a].$errors)};t[a].doValidate=m,o.xnSubmit&&angular.isFunction(s)&&i.bind("submit",function(){m(),t[a].$valid&&angular.isFunction(s)&&t.$apply(function(){s(t)})})}}}]).directive("xnFormSubmit",["$parse","XN_BEGIN_REQUEST","XN_END_REQUEST",function(e,n,t){"use strict";return{link:function(i,o,r){var a=e(r.xnFormSubmit),s=o.parents("form").attr("name"),l=i.$eval(s);if(!l)throw new Error("xnFormSubmit form is empty.");o.bind("click",function(){angular.isFunction(l.doValidate)&&l.doValidate(),l.$valid&&angular.isFunction(a)&&i.$apply(function(){a(i)})}),i.$on(n,function(){o.attr({disabled:"disabled"}),o.addClass("disabled")}),i.$on(t,function(){o.attr({disabled:"true"}),o.removeClass("disabled"),o.removeAttr("disabled")})}}}]).directive("xnSubmitEnter",["$parse","XN_BEGIN_REQUEST","XN_END_REQUEST",function(e,n,t){return{link:function(i,o,r){var a=e(r.xnSubmitEnter),s=o.parents("form").attr("name"),l=i.$eval(s);if(!l)throw new Error("xnSubmitEnter form is empty.");o.bind("click",function(){angular.isFunction(l.doValidate)&&l.doValidate(),l.$valid&&angular.isFunction(a)&&i.$apply(function(){a(i)})}),o.parents("form").bind("keydown keypress",function(e){if(13===e.which){var n=document.activeElement,t=!0;"false"==angular.element(n).attr("data-submit-enter")&&(t=!1),"textarea"!==n.type&&t&&(o.find("button").focus(),n.focus(),angular.isFunction(l.doValidate)&&l.doValidate(),e.preventDefault(),l.$valid&&angular.isFunction(a)&&i.$apply(function(){a(i)}))}}),i.$on(n,function(){o.attr({disabled:"disabled"}),o.addClass("disabled")}),i.$on(t,function(){o.attr({disabled:"true"}),o.removeClass("disabled"),o.removeAttr("disabled")})}}}]),angular.module("xn.directive.loading",[]).directive("xnNprogress",["XN_BEGIN_REQUEST","XN_END_REQUEST",function(e,n){return{restrict:"A",link:function(t){t.$on(e,function(){NProgress.start()}),t.$on(n,function(){NProgress.done()})}}}]),function(e,n){"function"==typeof define&&define.amd?define(n):"object"==typeof exports?module.exports=n():e.NProgress=n()}(this,function(){function e(e,n,t){return n>e?n:e>t?t:e}function n(e){return 100*(-1+e)}function t(e,t,i){var o;return o="translate3d"===c.positionUsing?{transform:"translate3d("+n(e)+"%,0,0)"}:"translate"===c.positionUsing?{transform:"translate("+n(e)+"%,0)"}:{"margin-left":n(e)+"%"},o.transition="all "+t+"ms "+i,o}function i(e,n){var t="string"==typeof e?e:a(e);return t.indexOf(" "+n+" ")>=0}function o(e,n){var t=a(e),o=t+n;i(t,n)||(e.className=o.substring(1))}function r(e,n){var t,o=a(e);i(e,n)&&(t=o.replace(" "+n+" "," "),e.className=t.substring(1,t.length-1))}function a(e){return(" "+(e.className||"")+" ").replace(/\s+/gi," ")}function s(e){e&&e.parentNode&&e.parentNode.removeChild(e)}var l={};l.version="0.1.6";var c=l.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};l.configure=function(e){var n,t;for(n in e)t=e[n],void 0!==t&&e.hasOwnProperty(n)&&(c[n]=t);return this},l.status=null,l.set=function(n){var i=l.isStarted();n=e(n,c.minimum,1),l.status=1===n?null:n;var o=l.render(!i),r=o.querySelector(c.barSelector),a=c.speed,s=c.easing;return o.offsetWidth,d(function(e){""===c.positionUsing&&(c.positionUsing=l.getPositioningCSS()),u(r,t(n,a,s)),1===n?(u(o,{transition:"none",opacity:1}),o.offsetWidth,setTimeout(function(){u(o,{transition:"all "+a+"ms linear",opacity:0}),setTimeout(function(){l.remove(),e()},a)},a)):setTimeout(e,a)}),this},l.isStarted=function(){return"number"==typeof l.status},l.start=function(){l.status||l.set(0);var e=function(){setTimeout(function(){l.status&&(l.trickle(),e())},c.trickleSpeed)};return c.trickle&&e(),this},l.done=function(e){return e||l.status?l.inc(.3+.5*Math.random()).set(1):this},l.inc=function(n){var t=l.status;return t?("number"!=typeof n&&(n=(1-t)*e(Math.random()*t,.1,.95)),t=e(t+n,0,.994),l.set(t)):l.start()},l.trickle=function(){return l.inc(Math.random()*c.trickleRate)},function(){var e=0,n=0;l.promise=function(t){return t&&"resolved"!=t.state()?(0==n&&l.start(),e++,n++,t.always(function(){n--,0==n?(e=0,l.done()):l.set((e-n)/e)}),this):this}}(),l.render=function(e){if(l.isRendered())return document.getElementById("nprogress");o(document.documentElement,"nprogress-busy");var t=document.createElement("div");t.id="nprogress",t.innerHTML=c.template;var i,r=t.querySelector(c.barSelector),a=e?"-100":n(l.status||0),d=document.querySelector(c.parent);return u(r,{transition:"all 0 linear",transform:"translate3d("+a+"%,0,0)"}),c.showSpinner||(i=t.querySelector(c.spinnerSelector),i&&s(i)),d!=document.body&&o(d,"nprogress-custom-parent"),d.appendChild(t),t},l.remove=function(){r(document.documentElement,"nprogress-busy"),r(document.querySelector(c.parent),"nprogress-custom-parent");var e=document.getElementById("nprogress");e&&s(e)},l.isRendered=function(){return!!document.getElementById("nprogress")},l.getPositioningCSS=function(){var e=document.body.style,n="WebkitTransform"in e?"Webkit":"MozTransform"in e?"Moz":"msTransform"in e?"ms":"OTransform"in e?"O":"";return n+"Perspective"in e?"translate3d":n+"Transform"in e?"translate":"margin"};var d=function(){function e(){var t=n.shift();t&&t(e)}var n=[];return function(t){n.push(t),1==n.length&&e()}}(),u=function(){function e(e){return e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(e,n){return n.toUpperCase()})}function n(e){var n=document.body.style;if(e in n)return e;for(var t,i=o.length,r=e.charAt(0).toUpperCase()+e.slice(1);i--;)if(t=o[i]+r,t in n)return t;return e}function t(t){return t=e(t),r[t]||(r[t]=n(t))}function i(e,n,i){n=t(n),e.style[n]=i}var o=["Webkit","O","Moz","ms"],r={};return function(e,n){var t,o,r=arguments;if(2==r.length)for(t in n)o=n[t],void 0!==o&&n.hasOwnProperty(t)&&i(e,t,o);else i(e,r[1],r[2])}}();return l});